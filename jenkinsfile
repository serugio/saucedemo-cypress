pipeline {
    agent any

    tools {nodejs "Node18"}

    environment {
       CHROME_BIN = '/bin/google-chrome'
   }

    stages {
        stage('checkout') {
            steps {
                // checkout scmGit(branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: 'serch', url: 'https://github.com/serugio/saucedemo-cypress']])
                checkout([$class: 'GitSCM', branches: [[name: "master"]], doGenerateSubmoduleConfigurations: false, extensions: [[$class: 'SubmoduleOption', disableSubmodules: false, parentCredentials: false, recursiveSubmodules: false, reference: '', trackingSubmodules: false]], submoduleCfg: [], userRemoteConfigs: [[credentialsId: 'serch', url: 'https://github.com/serugio/saucedemo-cypress']]])
            }
        }
    //     stage('Dependencies') {
    //        steps {
    //            npm i
    //        }
    //    }
    //     stage('Test') {
    //         steps {
    //             npm run E2ETest
                
    //         }
        // }
    }
}


   

   stages {
       
       stage('e2e Tests') {
         Parallel{
             stage('Test 1') {
                  steps {
                sh 'npm run cypress:ci'
                  }
               }
             
             stage('Test 2') {
                  steps {
                sh 'npm run cypress2:ci'
                  }
               }

       }
       stage('Deploy') {
           steps {
               echo 'Deploying....'
           }
       }
   }
}