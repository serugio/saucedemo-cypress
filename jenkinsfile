pipeline {
    agent any

//     tools {nodejs "Node18"}

//     environment {
//        CHROME_BIN = '/bin/google-chrome'
//    }

    stages {
        stage('checkout') {
            steps {
                checkout scmGit(
                    branches: [[name: '*/master']],
                    userRemoteConfigs: [[credentialsId: 'serch',
                        url: 'https://github.com/serugio/saucedemo-cypress']])
            }
        }
        stage('Dependencies') {
           steps {
               bat 'npm install'
           }
       }
        stage('Test') {
            steps {
                bat 'npm run E2ETest'
            }
        }
    }
    post {
        always {
            archiveArtifacts artifacts: 'mochawesome-report/**/*.*', fingerprint: true
        }
    }
}
